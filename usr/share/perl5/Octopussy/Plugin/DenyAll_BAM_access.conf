#@(#)sProxy - VERSION 2.3e
#
# $Id: access.conf,v 1.5.2.8 2005/01/06 13:09:36 rpriker Exp $
#

# Enable filtering on URIs *and* HTTP Headers
EAccessEnable	All

# Log file for allow/deny
EAccessLog	"| /usr/bin/logger -t 'sproxy BAM/briepicardie-enligne_RFC'"

# Default is to log Unnn grants & denies and Hnnn denies
EAccessLogLevel	1

# Log format
EAccessLogFormat	"%{Via}i %h \"%u\" %t "

# Temp dir for DATAs
EAccessTmpDir	/opt/sProxy/Prod/BAM/briepicardie-enligne_RFC/cache

# Default size for filtering & logging
#EAccessBufLength	8192
#EAccessLogLength	8192

# HTTP Headers
#EAccessHdrRule permit	"-i:^cookie: .{0,2048}$"
#EAccessHdrRule permit	"-i:^cookie2: .{0,2048}$"
#EAccessHdrRule permit	"-i:^range: .{0,2048}$"
#EAccessHdrRule permit	"-i:^referer: .{0,2048}$"
#EAccessHdrRule permit	"-i:^remote-cert: .{0,2048}$"
EAccessHdrRule deny=408	"-iv:^[-#$+._~a-z0-9]{1,64}: .{0,512}$"

# Default is to use "default" translations on URIs:
#   "&"    => "."
#   "|"    => "."
#   "\r\n" => "\\n"
#   "\n"   => "\\n"
# If needed "multipart-form-data" may be enabled.
#EAccessUriTrans	multipart-form-data

# Mask some private parameter(s)
EAccessUriTrans pencode=mask "CCPTE="
EAccessUriTrans pencode=mask "CCCRYC="
EAccessUriTrans pencode=mask "input_ccpte="
EAccessUriTrans pencode=mask "input_password="
EAccessUriTrans pencode=mask "INPUT_CCPTE="
EAccessUriTrans pencode=mask "INPUT_PASSWORD="
EAccessUriTrans pencode=mask "codeperso="
EAccessUriTrans pencode=mask "codeperso2="
EAccessUriTrans pencode=mask "codepersoconfirm="
EAccessUriTrans pencode=mask "SPMajCod_CCCRYC0="
EAccessUriTrans pencode=mask "SPMajCod_CCCRYC1="
EAccessUriTrans pencode=mask "SPMajCod_CCCRYC2="
EAccessUriTrans pencode=mask "SPMajAcc_CCCRYC="
EAccessUriTrans pencode=mask "PWD0="
EAccessUriTrans pencode=mask "PWD1="
EAccessUriTrans pencode=mask "PWD2="


# Decode some special parameter(s)
#EAccessUriTrans pdecode=asp.net "__VIEWSTATE="

# Outgoing content translatation
#EAccessContentTrans	"https://www.aquitaine-g2-enligne.credit-agricole.fr/"	"/"

# How does sProxy escape an URL  ?
# Per default,	2% , check for double %escape  
#		1% , !! unsafe
# Options   ,	1\x or \x , translate all "\xhh" characters  of the URI string
#		0\x, check "\xhh" characters in the URI string to deny access
#EAccessUriEscape 2%

# Check the encoding of each URL string !! MUST but after EAccessUriEscape
# Disable per default
#EAccessUriEncoding "UTF-8" "uri+args"

# "Standard" Web: deny "strange" methods
EAccessUriRule deny=406 "-iv:^(GET|HEAD|POST) "
#EAccessUriRule deny=406 "-iv:^(GET|HEAD|POST|OPTIONS) "

# "WebDAV" Web: deny "very strange" methods
#EAccessUriRule deny=406 "-iv:^[A-Z]{1,32} "

# HTTP Headers
#EAccessHdrRule permit	"-i:^cookie: .{0,2048}$"
#EAccessHdrRule permit	"-i:^cookie2: .{0,2048}$"
#EAccessHdrRule permit	"-i:^range: .{0,2048}$"
#EAccessHdrRule permit	"-i:^referer: .{0,2048}$"
#EAccessHdrRule permit	"-i:^remote-cert: .{0,2048}$"
EAccessHdrRule deny=408 "-iv:^[-#$+._~a-z0-9]{1,64}: .{0,512}$"

# Default denies
EAccessUriRule deny=409

# Unwanted: block some outgoing content
#EAccessContentRule deny "re..."

# Always before ACCESS.DENY
#EAccessUriRule exec "^POST ..." "/opt/sProxy/__XXXnet__/conf/EAexec %s"
#EAccessUriRule exec "^POST ..." "/opt/sProxy/__XXXnet__/conf/EApipe %s"

# ACCESS.DENY; does use deny=407...
include  /opt/sProxy/Prod/BAM/briepicardie-enligne_RFC/conf/access.deny

# PERMIT-ALL
EAccessUriRule permit "."

