<?xml version='1.0' encoding='UTF-8'?>
<octopussy_service description="Windows Services"
                   icon="operating_systems/os_windows"
                   name="Windows_Services"
                   version="201005190018"
                   website="http://www.intersectalliance.com/projects/SnareWindows/index.html">
  <message loglevel="Notice"
           msg_id="Windows_Services:service_stopped"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@STRING:event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@STRING:category@&gt;;;&lt;@REGEXP(&quot;(s|S)ervic.+stopped.+|.+(s|S)ervic.+stopped.+|(s|S)ervice stopped.+&quot;):msg@&gt;"
           rank="001"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Notice"
           msg_id="Windows_Services:service_started"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@STRING:event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@STRING:category@&gt;;;&lt;@REGEXP(&quot;(s|S)ervic.+started.+|.+(s|S)ervic.+started.+|(s|S)ervice started.+&quot;):msg@&gt;"
           rank="002"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Information"
           msg_id="Windows_Services:performance_counters_modified"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;&lt;@STRING:NULL@&gt;;&lt;@REGEXP(&quot;Performance counters for the .+ service were \w+ed successfully.+&quot;):msg@&gt;"
           rank="003"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Warning"
           msg_id="Windows_Services:reported_change_of_status"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;;&lt;@REGEXP(&quot;The .+ service reported a change of status to.+&quot;):msg@&gt;"
           rank="004"
           table="Windows_Message"
           taxonomy="Config.Changes" />
  <message loglevel="Information"
           msg_id="Windows_Services:service_successfully_sent_stop_control"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;;&lt;@REGEXP(&quot;.+service was successfully sent a stop control.+&quot;):msg@&gt;"
           rank="005"
           table="Windows_Message"
           taxonomy="Application.Stop" />
  <message loglevel="Information"
           msg_id="Windows_Services:service_successfully_sent_start_control"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;;&lt;@REGEXP(&quot;.+service was successfully sent a start control.+&quot;):msg@&gt;"
           rank="006"
           table="Windows_Message"
           taxonomy="Application.Start" />
  <message loglevel="Notice"
           msg_id="Windows_Services:service_entered_stopped_state"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;;&lt;@REGEXP(&quot;.+service entered the stopped state.+&quot;):msg@&gt;"
           rank="007"
           table="Windows_Message"
           taxonomy="Application.Stop" />
  <message loglevel="Notice"
           msg_id="Windows_Services:service_entered_running_state"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;;&lt;@REGEXP(&quot;.+service entered the running state.+&quot;):msg@&gt;"
           rank="008"
           table="Windows_Message"
           taxonomy="Application.Start" />
  <message loglevel="Information"
           msg_id="Windows_Services:agent_started"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Service&quot;):category@&gt;;;&lt;@REGEXP(&quot;(The.+Agent.+has started.+|Started the.+Agent.+)&quot;):msg@&gt;"
           rank="009"
           table="Windows_Message"
           taxonomy="Application.Start" />
  <message loglevel="Information"
           msg_id="Windows_Services:service_started_successfully"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@STRING:event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@STRING:category@&gt;;;&lt;@REGEXP(&quot;Servic.+start.+successfully.+|.+Servic.+start.+successfully.+|servic.+start.+successfully|.+servic.+start.+successfully&quot;):msg@&gt;"
           rank="010"
           table="Windows_Message"
           taxonomy="Application.Start" />
  <message loglevel="Information"
           msg_id="Windows_Services:idle_service_will_shut_down"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;;&lt;@REGEXP(&quot;.+Servic.+idle for.+it will be shut down.+&quot;):msg@&gt;"
           rank="011"
           table="Windows_Message"
           taxonomy="Application.Stop" />
  <message loglevel="Information"
           msg_id="Windows_Services:service_suspended_operation"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;;&lt;@REGEXP(&quot;.+Servic.+suspended operation.+&quot;):msg@&gt;"
           rank="012"
           table="Windows_Message"
           taxonomy="Application.Stop" />
  <message loglevel="Information"
           msg_id="Windows_Services:service_start_type_changed"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;;&lt;@REGEXP(&quot;.+start type of the.+service was changed.+&quot;):msg@&gt;"
           rank="013"
           table="Windows_Message"
           taxonomy="System" />
</octopussy_service>
