<?xml version='1.0' encoding='UTF-8'?>
<octopussy_service description="Windows System Logon Logoff"
                   icon="operating_systems/os_windows"
                   name="Windows_System_Logon_Logoff"
                   version="201005190018"
                   website="http://www.intersectalliance.com/projects/SnareWindows/index.html">
  <message loglevel="Notice"
           msg_id="Windows_System_Logon_Logoff:successful_network_logon"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;Successful Network Logon:.+&quot;):msg@&gt;"
           rank="001"
           table="Windows_Message"
           taxonomy="Auth.Success" />
  <message loglevel="Notice"
           msg_id="Windows_System_Logon_Logoff:user_logoff"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;User Logoff:.+&quot;):msg@&gt;"
           rank="002"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Information"
           msg_id="Windows_System_Logon_Logoff:service_ticket_granted"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Service Ticket Granted:.+&quot;):msg@&gt;"
           rank="003"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Notice"
           msg_id="Windows_System_Logon_Logoff:service_ticket_request_failed"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Failure Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Service Ticket Request Failed:.+&quot;):msg@&gt;"
           rank="004"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Notice"
           msg_id="Windows_System_Logon_Logoff:authentication_ticket_granted"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Authentication Ticket Granted:.+&quot;):msg@&gt;"
           rank="005"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Information"
           msg_id="Windows_System_Logon_Logoff:ticket_granted_renewed"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Ticket Granted Renewed:.+&quot;):msg@&gt;"
           rank="006"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Information"
           msg_id="Windows_System_Logon_Logoff:account_used_for_logon"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Account Used for Logon by:.+&quot;):msg@&gt;"
           rank="007"
           table="Windows_Message"
           taxonomy="Auth" />
  <message loglevel="Notice"
           msg_id="Windows_System_Logon_Logoff:session_disconnected_from_winstation"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;Session disconnected from winstation:.+&quot;):msg@&gt;"
           rank="008"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Notice"
           msg_id="Windows_System_Logon_Logoff:session_reconnected_to_winstation"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;Session reconnected to winstation:.+&quot;):msg@&gt;"
           rank="009"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Notice"
           msg_id="Windows_System_Logon_Logoff:successful_logon"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;Successful Logon:.+&quot;):msg@&gt;"
           rank="010"
           table="Windows_Message"
           taxonomy="Auth.Success" />
  <message loglevel="Warning"
           msg_id="Windows_System_Logon_Logoff:logon_to_account_failed"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Failure Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;The logon to account: .+ failed.+&quot;):msg@&gt;"
           rank="011"
           table="Windows_Message"
           taxonomy="Auth.Failure" />
  <message loglevel="Warning"
           msg_id="Windows_System_Logon_Logoff:unknown_user_bad_password"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Failure Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;Logon Failure:.+Unknown user name or bad password.+&quot;):msg@&gt;"
           rank="012"
           table="Windows_Message"
           taxonomy="Auth.Failure" />
  <message loglevel="Warning"
           msg_id="Windows_System_Logon_Logoff:pre_authentication_failed"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Failure Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Pre-authentication failed: .+&quot;):msg@&gt;"
           rank="013"
           table="Windows_Message"
           taxonomy="Auth.Failure" />
  <message loglevel="Warning"
           msg_id="Windows_System_Logon_Logoff:authentication_ticket_request_failed"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Failure Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Authentication Ticket Request Failed:.+&quot;):msg@&gt;"
           rank="014"
           table="Windows_Message"
           taxonomy="Auth.Failure" />
  <message loglevel="Notice"
           msg_id="Windows_System_Logon_Logoff:special_privileges_assigned_to_new_logon"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@STRING:category@&gt;;;&lt;@REGEXP(&quot;Special privileges assigned to new logon:.+&quot;):msg@&gt;"
           rank="015"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Notice"
           msg_id="Windows_System_Logon_Logoff:trusted_logon_process_registered_with_local_security_authority"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;System Event&quot;):category@&gt;;;&lt;@REGEXP(&quot;A trusted logon process has registered with the Local Security Authority.+This logon process will be trusted to submit logon requests.+&quot;):msg@&gt;"
           rank="016"
           table="Windows_Message"
           taxonomy="Auth" />
  <message loglevel="Information"
           msg_id="Windows_System_Logon_Logoff:logon_attempt"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Logon attempt by:.+&quot;):msg@&gt;"
           rank="017"
           table="Windows_Message"
           taxonomy="Auth" />
  <message loglevel="Information"
           msg_id="Windows_System_Logon_Logoff:user_initiated_logoff"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;User initiated logoff:.+&quot;):msg@&gt;"
           rank="018"
           table="Windows_Message"
           taxonomy="Auth.Success" />
  <message loglevel="Information"
           msg_id="Windows_System_Logon_Logoff:logon_using_explicit_credentials"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;Logon attempt using explicit credentials.+&quot;):msg@&gt;"
           rank="019"
           table="Windows_Message"
           taxonomy="Auth.Success" />
  <message loglevel="Information"
           msg_id="Windows_System_Logon_Logoff:service_ticket_request"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;.+ Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Service Ticket Request:.+&quot;):msg@&gt;"
           rank="020"
           table="Windows_Message"
           taxonomy="Auth" />
  <message loglevel="Information"
           msg_id="Windows_System_Logon_Logoff:authentication_ticket_request"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;.+ Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Authentication Ticket Request:.+&quot;):msg@&gt;"
           rank="021"
           table="Windows_Message"
           taxonomy="Auth" />
  <message loglevel="Information"
           msg_id="Windows_System_Logon_Logoff:service_ticket_renewed"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;.+ Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Service Ticket Renewed:.+&quot;):msg@&gt;"
           rank="022"
           table="Windows_Message"
           taxonomy="Auth" />
  <message loglevel="Warning"
           msg_id="Windows_System_Logon_Logoff:logon_failure_error_occured"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Failure Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;Logon Failure:.+An error occurred during logon.+&quot;):msg@&gt;"
           rank="023"
           table="Windows_Message"
           taxonomy="Auth.Failure" />
  <message loglevel="Information"
           msg_id="Windows_System_Logon_Logoff:logon_failure_password_expired"
           pattern="&lt;@DATE_TIME_ISO:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:src@&gt;;&lt;@NUMBER:event_count@&gt;;&lt;@DATE_TIME_APACHE_ERROR:datetime2@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@STRING:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Failure Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;.+The specified account's password has expired .+&quot;):msg@&gt;"
           rank="024"
           table="Windows_Message"
           taxonomy="Auth.Failure" />
</octopussy_service>
