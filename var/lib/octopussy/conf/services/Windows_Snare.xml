<?xml version='1.0' encoding='UTF-8'?>
<octopussy_service description="Windows Snare Agent Service"
                   icon="operating_systems/os_windows"
                   name="Windows_Snare"
                   nb_messages="018"
                   version="200807150002"
                   website="http://www.intersectalliance.com/projects/SnareWindows/index.html">
  <message loglevel="Notice"
           msg_id="Windows_Snare:service_was_stopped"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:NULL@&gt;;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@WORD:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@STRING:category@&gt;;;&lt;@REGEXP(&quot;The service was stopped..+&quot;):msg@&gt;"
           rank="008"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Notice"
           msg_id="Windows_Snare:service_was_started"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;&lt;@WORD:NULL@&gt;;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@WORD:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@STRING:category@&gt;;;&lt;@REGEXP(&quot;The service was started..+&quot;):msg@&gt;"
           rank="007"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Notice"
           msg_id="Windows_Snare:successful_network_logon"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@WORD:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;Successful Network Logon:.+&quot;):msg@&gt;"
           rank="001"
           table="Windows_Message"
           taxonomy="Auth.Success" />
  <message loglevel="Notice"
           msg_id="Windows_Snare:user_logoff"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@WORD:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;User Logoff:.+&quot;):msg@&gt;"
           rank="002"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Information"
           msg_id="Windows_Snare:service_ticket_granted"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@WORD:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Service Ticket Granted:.+&quot;):msg@&gt;"
           rank="003"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Notice"
           msg_id="Windows_Snare:service_ticket_request_failed"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@WORD:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Failure Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Service Ticket Request Failed:.+&quot;):msg@&gt;"
           rank="004"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Notice"
           msg_id="Windows_Snare:authentication_ticket_granted"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@WORD:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Authentication Ticket Granted:.+&quot;):msg@&gt;"
           rank="005"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Information"
           msg_id="Windows_Snare:ticket_granted_renewed"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@WORD:source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Ticket Granted Renewed:.+&quot;):msg@&gt;"
           rank="006"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Warning"
           msg_id="Windows_Snare:out_of_licenses"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Application;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;LicenseService&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Error&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;;&lt;@REGEXP(&quot;The product Windows Server is out of licenses.+&quot;):msg@&gt;"
           rank="009"
           table="Windows_Message"
           taxonomy="Config.Errors" />
  <message loglevel="Warning"
           msg_id="Windows_Snare:domain_policy_changed"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;Security&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Management&quot;):category@&gt;;;&lt;@REGEXP(&quot;Domain Policy Changed:.+&quot;):msg@&gt;"
           rank="010"
           table="Windows_Message"
           taxonomy="Config.Changes" />
  <message loglevel="Warning"
           msg_id="Windows_Snare:kerberos_policy_changed"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;Security&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Policy Change&quot;):category@&gt;;;&lt;@REGEXP(&quot;Kerberos Policy Changed:.+&quot;):msg@&gt;"
           rank="011"
           table="Windows_Message"
           taxonomy="Config.Changes" />
  <message loglevel="Notice"
           msg_id="Windows_Snare:master_merge_has_completed"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Application;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;Ci&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Devices&quot;):category@&gt;;;&lt;@REGEXP(&quot;Master merge has completed on .+&quot;):msg@&gt;"
           rank="012"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Information"
           msg_id="Windows_Snare:account_used_for_logon"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;Security&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;Account Used for Logon by:.+&quot;):msg@&gt;"
           rank="013"
           table="Windows_Message"
           taxonomy="Auth" />
  <message loglevel="Warning"
           msg_id="Windows_Snare:policy_objects_applied_successfully"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Application;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;SceCli&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;;&lt;@REGEXP(&quot;Security policy in the Group policy objects are applied successfully.+&quot;):msg@&gt;"
           rank="014"
           table="Windows_Message"
           taxonomy="Config.Changes" />
  <message loglevel="Notice"
           msg_id="Windows_Snare:session_disconnected_from_winstation"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;Security&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;Session disconnected from winstation:.+&quot;):msg@&gt;"
           rank="015"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Notice"
           msg_id="Windows_Snare:session_reconnected_to_winstation"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;Security&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;Session reconnected to winstation:.+&quot;):msg@&gt;"
           rank="016"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Notice"
           msg_id="Windows_Snare:new_process_created"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;Security&quot;):source@&gt;;&lt;@WORD:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Detailed Tracking&quot;):category@&gt;;;&lt;@REGEXP(&quot;A new process has been created:.+&quot;):msg@&gt;"
           rank="017"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Notice"
           msg_id="Windows_Snare:successful_logon"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;Security&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Success Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;Successful Logon:.+&quot;):msg@&gt;"
           rank="018"
           table="Windows_Message"
           taxonomy="Auth.Success" />
  <message loglevel="Information"
           msg_id="Windows_Snare:document_was_printed"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;System;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;Print&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;;&lt;@REGEXP(&quot;Document .+ owned by .+ was printed on .+&quot;):msg@&gt;"
           rank="019"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Information"
           msg_id="Windows_Snare:document_was_moved"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;System;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;Print&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Information&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;;&lt;@REGEXP(&quot;Document .+ owned by .+ was moved to position .+&quot;):msg@&gt;"
           rank="020"
           table="Windows_Message"
           taxonomy="System" />
  <message loglevel="Warning"
           msg_id="Windows_Snare:logon_to_account_failed"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;Security&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Failure Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Account Logon&quot;):category@&gt;;;&lt;@REGEXP(&quot;The logon to account: .+ failed..*&quot;):msg@&gt;;&lt;@NUMBER:NULL@&gt;"
           rank="021"
           table="Windows_Message"
           taxonomy="Auth.Failure" />
  <message loglevel="Warning"
           msg_id="Windows_Snare:error_reading_event_record"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Application;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;EvntAgnt&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Warning&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;None&quot;):category@&gt;;;&lt;@REGEXP(&quot;Error reading log event record.+&quot;):msg@&gt;;&lt;@NUMBER:NULL@&gt;"
           rank="022"
           table="Windows_Message"
           taxonomy="Application.Errors" />
  <message loglevel="Warning"
           msg_id="Windows_Snare:unknown_user_bad_password"
           pattern="&lt;@DATE_TIME_SYSLOG:datetime@&gt; &lt;@WORD:device@&gt; MSWinEventLog;&lt;@NUMBER:criticity@&gt;;Security;&lt;@NUMBER:NULL@&gt;;&lt;@DATE_TIME_APACHE_ERROR:NULL@&gt;;&lt;@NUMBER:event_id@&gt;;&lt;@REGEXP(&quot;Security&quot;):source@&gt;;&lt;@STRING:user@&gt;;&lt;@WORD:sid_type@&gt;;&lt;@REGEXP(&quot;Failure Audit&quot;):event_type@&gt;;&lt;@WORD:computer@&gt;;&lt;@REGEXP(&quot;Logon/Logoff&quot;):category@&gt;;;&lt;@REGEXP(&quot;Logon Failure:.+Unknown user name or bad password.+&quot;):msg@&gt;;&lt;@NUMBER:NULL@&gt;"
           rank="023"
           table="Windows_Message"
           taxonomy="Auth.Failure" />
</octopussy_service>
